(function(b){var a=0;ObjectQueue=function(c){this._QOPT_DEQ_CLEAN=1;if(c==null){c=this._QOPT_DEQ_CLEAN}this._qid=(a++);this._qlen=0;this._qhead=null;this._qtail=null;this.qoption=c;this.ENABLE_MASK=1;this.DISABLE_MASK=0;this.current_mask="default";this.MASKED=1;this.UNMASKED=0;this.NEAREST=true;this.FARTHEST=false;this.MANHATTAN=true;this.EUCLID=false;this.x_key="x";this.y_key="y";this.INC_SORT=true;this.DEC_SORT=false;this.sort_type=0};ObjectQueue.prototype.get_version=function(){return"1.25"};ObjectQueue.prototype.enqueue=function(d,c){if(c==null){c=this.ENABLE_MASK}if(d){if(!d.queued){d.queued=0}if(!d.q_previous){d.q_previous=new Array()}if(!d.q_next){d.q_next=new Array()}if(!d.q_mask){d.q_mask=new Array()}if(!d.o_mask){d.o_mask=new Object()}d.queued++;d.q_previous[this._qid]=this._qtail;d.q_next[this._qid]=null;d.q_mask[this._qid]=c;if(this._qlen==0){this._qhead=d}else{this._qtail.q_next[this._qid]=d}this._qtail=d;this._qlen++}else{trace("ERROR: enqueue null mc.")}};ObjectQueue.prototype.dequeue=function(e,f){var d;if(e==null||f==null){e=""}if(this._qlen<=0){return null}if(e!=""){for(d=this._qhead;d;d=d.q_next[this._qid]){if(d[e]==f){if(this._qhead==d){this._qhead=d.q_next[this._qid];if(d.q_next[this._qid]){d.q_next[this._qid].q_previous[this._qid]=null}}else{d.q_previous[this._qid].q_next[this._qid]=d.q_next[this._qid];if(d.q_next[this._qid]){d.q_next[this._qid].q_previous[this._qid]=d.q_previous[this._qid]}}if(this._qtail==d){this._qtail=d.q_previous[this._qid]}this._qlen--;d.q_previous[this._qid]=null;d.q_next[this._qid]=null;d.q_mask[this._qid]=this.UNMASKED;if((--d.queued)==0&&(this.qoption&this.QOPT_DEQ_CLEAN)){delete d.q_previous;delete d.q_next;delete d.q_mask;d.q_previous=null;d.q_next=null;d.q_mask=null}return d}}return null}else{var c=this._qhead;if(c==null){return null}this._qhead=this._qhead.q_next[this._qid];if(this._qhead){this._qhead.q_previous[this._qid]=null}else{this._qtail=null}c.q_previous[this._qid]=null;c.q_next[this._qid]=null;c.q_mask[this._qid]=this.UNMASKED;this._qlen--;if((--c.queued)==0&&(this.qoption&this.QOPT_DEQ_CLEAN)){delete c.q_previous;delete c.q_next;delete c.q_mask;d.q_previous=null;d.q_next=null;d.q_mask=null}return c}};ObjectQueue.prototype.removeall=function(c){return this._removeall(c,0)};ObjectQueue.prototype.deleteall=function(c){return this._removeall(c,1)};ObjectQueue.prototype._removeall=function(d,e){if(d==null){d=this.DISABLE_MASK}var c=this._qlen;for(var f=0;f<c;f++){if(d==this.DISABLE_MASK||this._qhead[this._qid]==this.MASKED){var g=this.dequeue();if(e){delete g}}}};ObjectQueue.prototype.setmaskmc=function(c){if(c){c.q_mask[this._qid]=this.MASKED}};ObjectQueue.prototype.resetmaskmc=function(c){if(c){c.q_mask[this._qid]=this.UNMASKED}};ObjectQueue.prototype.setmask=function(c,e){var d;for(d=this._qhead;d;d=d.q_next[this._qid]){if(d[c]==e){d.q_mask[this._qid]=this.MASKED}}};ObjectQueue.prototype.resetmask=function(c,e){var d;for(d=this._qhead;d;d=d.q_next[this._qid]){if(d[c]==e){d.q_mask[this._qid]=this.UNMASKED}}};ObjectQueue.prototype.setmaskall=function(){var c;for(c=this._qhead;c;c=c.q_next[this._qid]){c.q_mask[this._qid]=this.MASKED}};ObjectQueue.prototype.resetmaskall=function(){var c;for(c=this._qhead;c;c=c.q_next[this._qid]){c.q_mask[this._qid]=this.UNMASKED}};ObjectQueue.prototype.get_current_mask=function(){return this.current_mask};ObjectQueue.prototype.new_mask=function(c,d){if(!d){d=this.UNMASKED}for(mc=this._qhead;mc;mc=mc.q_next[this._qid]){mc.o_mask[this.current_mask]=mc.q_mask[this._qid];mc.q_mask[this._qid]=d}this.current_mask=c};ObjectQueue.prototype.save_mask=function(c){if(!c){c=this.current_mask}for(mc=this._qhead;mc;mc=mc.q_next[this._qid]){mc.o_mask[c]=mc.q_mask[this._qid]}};ObjectQueue.prototype.load_mask=function(c){for(mc=this._qhead;mc;mc=mc.q_next[this._qid]){if(typeof(mc.o_mask[c])=="undefined"){mc.o_mask[c]=this.UNMASKED}mc.q_mask[this._qid]=mc.o_mask[c]}this.current_mask=c};ObjectQueue.prototype.change_mask=function(c){for(mc=this._qhead;mc;mc=mc.q_next[this._qid]){mc.o_mask[this.current_mask]=mc.q_mask[this._qid];if(typeof(mc.o_mask[c])=="undefined"){mc.o_mask[c]=this.UNMASKED}mc.q_mask[this._qid]=mc.o_mask[c]}this.current_mask=c};ObjectQueue.prototype.head=function(c){if(c==null){c=this.DISABLE_MASK}if(this._qhead==null){return this._qhead}if(c==this.ENABLE_MASK&&this._qhead.q_mask[this._qid]==this.UNMASKED){return this.next(this._qhead,this.ENABLE_MASK)}else{return this._qhead}};ObjectQueue.prototype.tail=function(c){if(c==null){c=this.DISABLE_MASK}if(c==this.ENABLE_MASK&&this._qtail.q_mask[this._qid]==this.UNMASKED){return this._qtail.previous(this.ENABLE_MASK)}else{return this._qtail}};ObjectQueue.prototype.next=function(d,c){if(c==null){c=this.DISABLE_MASK}if(d){d=d.q_next[this._qid];if(c==this.ENABLE_MASK){while(d&&d.q_mask[this._qid]==this.UNMASKED){d=d.q_next[this._qid]}}return d}else{return null}};ObjectQueue.prototype.previous=function(d,c){if(c==null){c=this.DISABLE_MASK}if(d){d=d.q_previous[this._qid];if(c==this.ENABLE_MASK){while(d&&d.q_mask[this._qid]==this.UNMASKED){d=d.q_previous[this._qid]}}return d}else{return null}};ObjectQueue.prototype.refer=function(c){var d;var e;if(c<0||c>this._qlen-1){return null}for(d=0,e=this._qhead;d<c;d++){e=e.q_next[this._qid]}return e};ObjectQueue.prototype.length=function(c){if(c==null){c=this.DISABLE_MASK}if(c==this.ENABLE_MASK){var d=0;for(var e=this._qhead;e;e=e.q_next[this._qid]){if(e.q_mask[this._qid]==this.MASKED){d++}}return d}else{return this._qlen}};ObjectQueue.prototype.count=function(e,g,c){var f;if(c==null){c=this.DISABLE_MASK}var d=0;for(f=this._qhead;f;f=f.q_next[this._qid]){if(f[e]==g&&(c==this.DISABLE_MASK||f.q_mask[this._qid]==this.MASKED)){d++}}return d};ObjectQueue.prototype.search=function(d,f,c,g){if(c==null){c=this.DISABLE_MASK}var e=this._qhead;if(g){e=g}for(;e;e=e.q_next[this._qid]){if(e[d]==f&&(c==this.DISABLE_MASK||e.q_mask[this._qid]==this.MASKED)){return e}}return null};ObjectQueue.prototype.search_index=function(e,g,c,h){var d=0;var f=this._qhead;if(c==null){c=this.DISABLE_MASK}if(h==null){h=-1}if(h>-1){d=h;f=refer(d)}for(;f;d++,f=f.q_next[this._qid]){if(f[e]==g&&(c==this.DISABLE_MASK||f.q_mask[this._qid]==this.MASKED)){return d}}return -1};ObjectQueue.prototype.min=function(d,c){return this._minmax(d,true,c)};ObjectQueue.prototype.max=function(d,c){return this._minmax(d,false,c)};ObjectQueue.prototype._minmax=function(f,g,d){if(d==null){d=this.DISABLE_MASK}if(this._qlen==0){return null}if(this._qlen==1){return this._qhead}var e=this._qhead[f];var i=this._qhead;var c=0;var h=this._qhead.q_next[this._qid];if(d==this.ENABLE_MASK&&this._qhead.q_mask[this._qid]==this.UNMASKED){i=null;for(;h;h=h.q_next[this._qid]){if(h.q_mask[this._qid]==this.MASKED){i=h;e=h[f];h=h.q_next[this._qid];break}}}for(;h;h=h.q_next[this._qid]){var j=Number(h[f]);if((j<e)==g&&(d==this.DISABLE_MASK||h.q_mask[this._qid]==this.MASKED)){e=j;i=h}}return i};ObjectQueue.prototype.set_position_search_key=function(c,d){this.x_key=c;this.y_key=d};ObjectQueue.prototype.position_search=function(j,i,f,h){if(f==null){f=this.DISABLE_MASK}if(h==null){h=this.EUCLID}if(this._qlen<2){return null}if(f==this.ENABLE_MASK&&length(f)<2){return null}var g;var e=null;var d;for(d=this._qhead;d;d=d.q_next[this._qid]){if(d!=j&&(f==this.DISABLE_MASK||d.q_mask[this._qid]==this.MASKED)){g=mlength(d,j,h);e=d;break}}if(e==null){return null}for(;d;d=d.q_next[this._qid]){var c=mlength(d,j,h);if(d!=j&&(c<g)==i&&(f==this.DISABLE_MASK||d.q_mask[this._qid]==this.MASKED)){g=c;e=d}}return e};ObjectQueue.prototype.position_range_search_count=function(j,h,e,f,i){if(f==null){f=this.DISABLE_MASK}if(i==null){i=this.EUCLID}if(this._qlen<2){return 0}var g=0;if(i==this.EUCLID){h*=h;e*=e}for(var d=this._qhead.q_next[this._qid];d;d=d.q_next[this._qid]){var c=mlength(d,j,i);if(d!=j&&c>=h&&c<=e&&(f==this.DISABLE_MASK||d.q_mask[this._qid]==this.MASKED)){g++}}return g};ObjectQueue.prototype.mlength=function(d,c,e){if(e==null){e=this.EUCLID}if(e==this.MANHATTAN){return this.abs(d[this.x_key]-c[this.x_key])+this.abs(d[this.y_key]-c[this.y_key])}else{return(d[this.x_key]-c[this.x_key])*(d[this.x_key]-c[this.x_key])+(d[this.y_key]-c[this.y_key])*(d[this.y_key]-c[this.y_key])}};ObjectQueue.prototype.abs=function(c){if(c<0){return -c}return c};ObjectQueue.prototype.sort_algorithm=function(c){if(c==0||c=="auto"){this.sort_type=0}else{if(c==1||c=="bubble"){this.sort_type=1}else{if(c==2||c=="quick"){this.sort_type=2}else{this.sort_type=0}}}};ObjectQueue.prototype.sort=function(d,c){if(c==null){c=this.INC_SORT}if(this._qlen<2){return}if(this.sort_type==0){if(1){this._quick_sort(d,c)}else{this._bubble_sort(d,c)}}else{if(this.sort_type==1){this._bubble_sort(d,c)}else{this._quick_sort(d,c)}}};ObjectQueue.prototype._bubble_sort=function(f,e){for(var d=1;d<=this._qlen-1;d++){for(var c=0;c<this._qlen-d;c++){var g=this.refer(c);if(g&&g.q_next[this._qid]){if((g[f]>g.q_next[this._qid][f])==e){this.transpose_next(g)}}}}};ObjectQueue.prototype.transpose_next=function(d){if(this._qlen<2){return}if(d==this._qhead){this._qhead=d.q_next[this._qid]}else{d.q_previous[this._qid].q_next[this._qid]=d.q_next[this._qid]}if(d.q_next[this._qid]==this._qtail){this._qtail=d}else{d.q_next[this._qid].q_next[this._qid].q_previous[this._qid]=d}d.q_next[this._qid].q_previous[this._qid]=d.q_previous[this._qid];d.q_previous[this._qid]=d.q_next[this._qid];var c=d.q_next[this._qid].q_next[this._qid];d.q_next[this._qid].q_next[this._qid]=d;d.q_next[this._qid]=c};ObjectQueue.prototype._quick_sort=function(d,c){this._quick_sort_core(d,c,this._qhead,this._qtail)};ObjectQueue.prototype._quick_sort_core=function(g,n,h,j){var m=h;var k=this.next(h);if(k){m=k}var f=h;var l=j;while(true){var c=0;while((f[g]<m[g])==n&&f[g]!=m[g]){if(f==l){c=1;break}if(this.next(f)){f=this.next(f)}else{c=1;break}}while((m[g]<l[g])==n&&m[g]!=l[g]){if(f==l){c=1;break}if(this.previous(l)){l=this.previous(l)}else{c=1;break}}while(this.next(f)&&this.next(f)[g]==f[g]&&f!=l){f=this.next(f);if(f==l){c=1;break}}while(this.previous(l)&&this.previous(l)[g]==l[g]&&f!=l){l=this.previous(l);if(f==l){c=1;break}}if(f==l||c){break}var e=this.next(f);var o=this.previous(l);if(f==h){h=l}if(l==j){j=f}if(e==null){e=h}if(o==null){o=j}this.swap(f,l);f=e;l=o;if(f==l){break}}var d;var i;d=null;i=null;if(f!=h){if(f!=j){d=f}else{if(this.previous(f)&&this.previous(f)!=h){d=this.previous(f)}}}if(l!=j){i=l}if(d){this._quick_sort_core(g,n,h,d)}if(i){this._quick_sort_core(g,n,i,j)}};ObjectQueue.prototype.swap=function(e,d){if(this._qlen<2){return}if(e==this._qhead){this._qhead=d}else{if(d==this._qhead){this._qhead=e}}if(e==this._qtail){this._qtail=d}else{if(d==this._qtail){this._qtail=e}}if(e.q_next[this._qid]){if(e.q_next[this._qid]!=d){e.q_next[this._qid].q_previous[this._qid]=d}else{}}if(e.q_previous[this._qid]){if(e.q_previous[this._qid]!=d){e.q_previous[this._qid].q_next[this._qid]=d}else{}}if(d.q_next[this._qid]){if(d.q_next[this._qid]!=e){d.q_next[this._qid].q_previous[this._qid]=e}else{}}if(d.q_previous[this._qid]){if(d.q_previous[this._qid]!=e){d.q_previous[this._qid].q_next[this._qid]=e}else{}}var c=d.q_next[this._qid];if(e.q_next[this._qid]==d){d.q_next[this._qid]=e}else{d.q_next[this._qid]=e.q_next[this._qid]}if(c==e){e.q_next[this._qid]=d}else{e.q_next[this._qid]=c}c=d.q_previous[this._qid];if(e.q_previous[this._qid]==d){d.q_previous[this._qid]=e}else{d.q_previous[this._qid]=e.q_previous[this._qid]}if(c==e){e.q_previous[this._qid]=d}else{e.q_previous[this._qid]=c}}}(window));